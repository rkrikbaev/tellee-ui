<link rel="import" href="../polymer/polymer.html" />

<link rel="import" href="../px-d3-imports/px-d3-imports.html" />
<script src="d3-timelines.js"></script>

<style type="text/css">
    .axis path,
    .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
    }

    .axis text {
        font-family: sans-serif;
        font-size: 10px;
    }

    .timeline-label {
        font-family: sans-serif;
        font-size: 12px;
    }

    #timeline2 .axis {
			transform: translate(0px, 40px);
			-ms-transform: translate(0px, 40px);
			/* IE 9 */
			-webkit-transform: translate(0px, 40px);
			/* Safari and Chrome */
			-o-transform: translate(0px, 40px);
			/* Opera */
			-moz-transform: translate(0px, 40px);
			/* Firefox */
    }

    .coloredDiv {
			height: 40px;
			width: 20px;
			float: left;
    }

	div.tooltip {
		position: absolute;
		text-align: center;
		width: 300px;
		height: 28px;
		padding: 2px;
		font: 12px sans-serif;
		background: lightsteelblue;
		border: 0px;
		border-radius: 8px;
		pointer-events: none;
	}
</style>



<dom-module id="polymer-d3-timeline">
  <template id="template">
		<div width="100%" id="timeline"></div>
		<div width="100%" id="info"></div>	
  </template>
</dom-module>



<script>
  Polymer({

    is: 'polymer-d3-timeline',

    /**
     * Properties block, expose attribute values to the DOM via 'reflect'
     *
     * @property properties
     * @type Object
     */
    properties: {
      /**
       * Current value of the gauge.
       * @property value
       * @type {Array}
       * @default `0`
       */
			data: {
				type: Array,
				value: []
			},
			width: {
				type: Number,
				value: 300,
				observer: '_changeWidth'
      },
			height: {
				type: Number,
				value: 100,
				observer: '_changeHeight'
			}
		},
		
		_changeWidth: function () {
			if (this.width) {
				this.properties.width = this.width;
				d3.select(this.$$("#timeline svg")).remove();
				d3.select(this.$$("#info p")).remove();
				this.attached();
			}
		},
		_changeHeight: function () {
			if (this.height) {
				this.properties.height = this.height;
				d3.select(this.$$("#timeline svg")).remove();
				d3.select(this.$$("#info p")).remove();
				this.attached();
			}
		},
		attached: function () {
			console.log(this.data);
			this.properties.data = this.data;
      var testData = [
				{ times: this.properties.data },
      ];
			var chart = d3.timelines();
			chart.itemHeight(this.properties.height - 100);
      var svg = d3.select(this.$$('#timeline')).append("svg").attr("width", this.properties.width).attr("height", this.properties.height - 40)
				.datum(testData).call(chart);
			
			var par = d3.select(this.$$("#info")).append("p").html("here");
    }

  });
</script>
